(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{616:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[a("strong",[s._v("说明")])]),s._v(" "),a("p",[s._v("以前Docker，流程是单个容器通过编写Dockerfile， build，run来手动操作。")]),s._v(" "),a("p",[s._v("使用DockerCompose来轻松高效管理容器，定义运行多个容器。")]),s._v(" "),a("p",[s._v("Compose是用于定义和运行多容器Docker应用程序的工具。通过Compose，您可以使用YAML文件来配置应用程序的服务。然后，使用一个命令，就可以从配置中创建并启动所有服务。")]),s._v(" "),a("p",[s._v("官方文档https://docs.docker.com/compose/")]),s._v(" "),a("p",[a("strong",[s._v("使用流程")])]),s._v(" "),a("ol",[a("li",[s._v("Dockerfile来保证项目可运行")]),s._v(" "),a("li",[s._v("定义组成应用程序服务"),a("code",[s._v("service")]),s._v("。 文件"),a("code",[s._v("docker-compose.yml")])]),s._v(" "),a("li",[s._v("启动项目"),a("code",[s._v("docker-compose up")])])]),s._v(" "),a("p",[s._v("示例yml")]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2.0'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Web服务")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5000:5000"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/code\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" logvolume01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/log\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redis服务")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logvolume01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}}),s._v(" 安装")]),s._v(" "),a("p",[s._v("Docker Compose依靠Docker Engine. 所以确保已安装Docker.")]),s._v(" "),a("p",[s._v("默认Mac系统已经安装了。或者也可以使用pip包安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-compose\n")])])]),a("p",[a("strong",[s._v("Linux加速安装")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.下载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://get.daocloud.io/docker/compose/releases/download/1.24.1/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -o /usr/local/bin/docker-compose\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.授权")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("➜  ~ docker-compose version\ndocker-compose version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.26")]),s._v(".2, build eefe0d31\ndocker-py version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".2\nCPython version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v(".7\nOpenSSL version: OpenSSL "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(".1g  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("➜  ~ docker-compose\nDefine and run multi-container applications with Docker.\n\nUsage:\n  docker-compose "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-f "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("COMMAND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ARGS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  docker-compose -h"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--help\n\nOptions:\n  -f, --file FILE             Specify an alternate compose "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n                              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default: docker-compose.yml"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -p, --project-name NAME     Specify an alternate project name\n                              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default: directory name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -c, --context NAME          Specify a context name\n  --verbose                   Show "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" output\n  --log-level LEVEL           Set log level "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DEBUG, INFO, WARNING, ERROR, CRITICAL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  --no-ansi                   Do not print ANSI control characters\n  -v, --version               Print version and "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n  -H, --host HOST             Daemon socket to connect to\n\n  --tls                       Use TLS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" implied by --tlsverify\n  --tlscacert CA_PATH         Trust certs signed only by this CA\n  --tlscert CLIENT_CERT_PATH  Path to TLS certificate "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n  --tlskey TLS_KEY_PATH       Path to TLS key "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n  --tlsverify                 Use TLS and verify the remote\n  --skip-hostname-check       Don"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t check the daemon'")]),s._v("s "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" against the\n                              name specified "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the client certificate\n  --project-directory "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v("    Specify an alternate working directory\n                              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default: the path of the Compose "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  --compatibility             If set, Compose will attempt to convert keys\n                              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" v3 files to their non-Swarm equivalent\n  --env-file "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v("             Specify an alternate environment "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n\nCommands:\n  build              Build or rebuild services\n  config             Validate and view the Compose "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n  create             Create services\n  down               Stop and remove containers, networks, images, and volumes\n  events             Receive real "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" events from containers\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("               Execute a "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a running container\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v("               Get "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" on a "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n  images             List images\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v("               Kill containers\n  logs               View output from containers\n  pause              Pause services\n  port               Print the public port "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a port binding\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("                 List containers\n  pull               Pull "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" images\n  push               Push "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" images\n  restart            Restart services\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v("                 Remove stopped containers\n  run                Run a one-off "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n  scale              Set number of containers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("\n  start              Start services\n  stop               Stop services\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v("                Display the running processes\n  unpause            Unpause services\n  up                 Create and start containers\n  version            展示docker-compose的版本信息\n")])])]),a("h3",{attrs:{id:"快速体验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速体验"}}),s._v(" 快速体验")]),s._v(" "),a("p",[a("strong",[s._v("步骤")])]),s._v(" "),a("ol",[a("li",[s._v("应用")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("➜  Desktop "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" composetest\n➜  Desktop "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" composetest\n")])])]),a("p",[a("code",[s._v("app.py")])]),s._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" time\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" redis\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" flask "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Flask\n\napp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Flask"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__name__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncache "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'redis'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_hit_count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    retries "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("incr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hits'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("except")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exceptions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ConnectionError "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" exc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" retries "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" exc\n            retries "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n            time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" get_hit_count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello World! I have been seen {} times.\\n'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[a("code",[s._v("requirements.txt")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("flask\nredis\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("Dockerfile 应用打包镜像")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("FROM "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v(".4-alpine3.10\nWORKDIR /code\nENV FLASK_APP app.py\nENV FLASK_RUN_appHOST "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\nRUN apk "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" --no-cache gcc musl-dev linux-headers\nCOPY requirements.txt requirements.txt\nRUN pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -r requirements.txt\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\nCOPY "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nCMD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flask"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"run"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[s._v("Docker-compose.yaml 定义整个服务")])]),s._v(" "),a("li",[a("p",[s._v("启动Docker-compose")])])]),s._v(" "),a("p",[s._v("定义一个"),a("code",[s._v("docker-compose.yaml")])]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5000:5000"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis:alpine"')]),s._v("\n")])])]),a("p",[s._v("在项目根目录打开终端，构建并且运行项目")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker-compose build\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker-compose up\n")])])]),a("p",[s._v("停止运行")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker-compose down\n")])])]),a("p",[a("img",{attrs:{src:"http://alicdn.itaolaity.com/blog/20200904184458.png",alt:""}})]),s._v(" "),a("p",[s._v("然后我们再看看Docker网络")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://alicdn.itaolaity.com/blog/20200904184652.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"http://alicdn.itaolaity.com/blog/20200904184806.png",alt:""}})]),s._v(" "),a("p",[s._v("下面代码是运行时的")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("➜  composetest docker-compose build\nredis uses an image, skipping\nBuilding web\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" FROM python:3.7-alpine\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v("-alpine: Pulling from library/python\ndf20fa9351a1: Pull complete\n36b3adc4ff6f: Pull complete\n4db9de03f499: Pull complete\ncd38a04a61f4: Pull complete\n6bbb0c43b470: Pull complete\nDigest: sha256:d1375bf0b889822c603622dc137b24fb7064e6c1863de8cc4262b61901ce4390\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" python:3.7-alpine\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 078114edb6be\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" WORKDIR /code\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" fd9621a21c66\nRemoving intermediate container fd9621a21c66\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 3fb596445a6d\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENV FLASK_APP app.py\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 59774f148143\nRemoving intermediate container 59774f148143\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c8ddb45af25e\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENV FLASK_RUN_HOST "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 6f33dd2d0008\nRemoving intermediate container 6f33dd2d0008\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ccd759a4a9bf\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN apk "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" --no-cache gcc musl-dev linux-headers\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 7b3c7abb835d\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.12/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.12/community/x86_64/APKINDEX.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing libgcc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.3")]),s._v(".0-r2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing libstdc++ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.3")]),s._v(".0-r2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing binutils "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.34")]),s._v("-r1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing gmp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.2")]),s._v(".0-r0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing isl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.18")]),s._v("-r0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing libgomp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.3")]),s._v(".0-r2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing libatomic "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.3")]),s._v(".0-r2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing libgphobos "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.3")]),s._v(".0-r2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing mpfr4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.0")]),s._v(".2-r4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing mpc1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(".0-r1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing gcc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.3")]),s._v(".0-r2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing linux-headers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.4")]),s._v(".5-r1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("/13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Installing musl-dev "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(".24-r9"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nExecuting busybox-1.31.1-r16.trigger\nOK: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("153")]),s._v(" MiB "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v(" packages\nRemoving intermediate container 7b3c7abb835d\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 20773301e6af\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" COPY requirements.txt requirements.txt\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 43c4fdd4899f\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -r requirements.txt\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" b3aad024091c\nCollecting flask\n  Downloading Flask-1.1.2-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCollecting redis\n  Downloading redis-3.5.3-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("72")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCollecting itsdangerous"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.24")]),s._v("\n  Downloading itsdangerous-1.1.0-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCollecting Jinja"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.10")]),s._v(".1\n  Downloading Jinja2-2.11.2-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("125")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCollecting Werkzeug"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.15")]),s._v("\n  Downloading Werkzeug-1.0.1-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("298")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCollecting click"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.1")]),s._v("\n  Downloading click-7.1.2-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCollecting MarkupSafe"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.23")]),s._v("\n  Downloading MarkupSafe-1.1.1.tar.gz "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nBuilding wheels "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" collected packages: MarkupSafe\n  Building wheel "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" MarkupSafe "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("setup.py"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": started\n  Building wheel "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" MarkupSafe "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("setup.py"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": finished with status "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'done'")]),s._v("\n  Created wheel "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" MarkupSafe: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("filename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("MarkupSafe-1.1.1-cp37-cp37m-linux_x86_64.whl "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16913")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sha256")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("905a2d3551601b1bdabf54e7d39408a7ed322407d1462d0affd27e415fe80449\n  Stored "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" directory: /root/.cache/pip/wheels/b9/d9/ae/63bf9056b0a22b13ade9f6b9e08187c1bb71c47ef21a8c9924\nSuccessfully built MarkupSafe\nInstalling collected packages: itsdangerous, MarkupSafe, Jinja2, Werkzeug, click, flask, redis\nSuccessfully installed Jinja2-2.11.2 MarkupSafe-1.1.1 Werkzeug-1.0.1 click-7.1.2 flask-1.1.2 itsdangerous-1.1.0 redis-3.5.3\nRemoving intermediate container b3aad024091c\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 8a1840ed2c6f\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" EXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" aea130f1e6ee\nRemoving intermediate container aea130f1e6ee\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" fe200f749e07\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" COPY "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" e9e54c6fb4ad\nStep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("/10 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flask"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"run"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 2845bd8fdb17\nRemoving intermediate container 2845bd8fdb17\n ---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 84fc6ba7b059\nSuccessfully built 84fc6ba7b059\nSuccessfully tagged composetest_web:latest\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("➜  composetest docker-compose up\nCreating network "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"composetest_default"')]),s._v(" with the default driver\nPulling redis "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("redis:alpine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nalpine: Pulling from library/redis\ndf20fa9351a1: Already exists\n9b8c029ceab5: Pull complete\ne983a1eb737a: Pull complete\n3ff995df75b6: Pull complete\n53083afa127f: Pull complete\n2509483afa4c: Pull complete\nDigest: sha256:5326e0af4341affe12c544b546f17e4fcb5db2d9204a83e5c28d8b8a98d69778\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" redis:alpine\nCreating composetest_web_1   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\nCreating composetest_redis_1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\nAttaching to composetest_redis_1, composetest_web_1\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":C 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.245 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo")]),s._v("\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":C 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.245 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redis version=6.0.7, bits=64, commit=00000000, modified=0, pid=1, just started")]),s._v("\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":C 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.245 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf")]),s._v("\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":M 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.246 * Running "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("standalone, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(".\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":M 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.247 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.")]),s._v("\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":M 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.247 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Server initialized")]),s._v("\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":M 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.247 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.")]),s._v("\nredis_1  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":M 04 Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":36:23.247 * Ready to accept connections\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  * Serving Flask app "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app.py"')]),s._v("\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  * Environment: production\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    WARNING: This is a development server. Do not use it "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a production deployment.\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    Use a production WSGI server instead.\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  * Debug mode: off\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  * Running on http://0.0.0.0:5000/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Press CTRL+C to quit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.1 - - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("04/Sep/2020 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":41:25"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET / HTTP/1.1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" -\nweb_1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.18")]),s._v(".0.1 - - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("04/Sep/2020 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":41:25"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(' "GET /favicon.ico HTTP/1.1\n')])])]),a("h3",{attrs:{id:"yaml规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yaml规则"}}),s._v(" yaml规则")]),s._v(" "),a("p",[s._v("官方文档")]),s._v(" "),a("p",[s._v("https://docs.docker.com/compose/compose-file/")]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 版本 与Docker版本对应 比如1.x 2.x 3.x")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务1:web")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务2:redis")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n\t\t"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine\n\t\t"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6379"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" frontend\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其他配置 比如 网络/卷 全局规则")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("configs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])])]),a("h2",{attrs:{id:"说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#说明"}}),s._v(" 说明")]),s._v(" "),a("p",[s._v("官方文档")]),s._v(" "),a("p",[s._v("https://docs.docker.com/compose/")]),s._v(" "),a("p",[s._v("DaoCloud")]),s._v(" "),a("p",[s._v("https://www.daocloud.io/mirror")])])}),[],!1,null,null,null);t.default=e.exports}}]);