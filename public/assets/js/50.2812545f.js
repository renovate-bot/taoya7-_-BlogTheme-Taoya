(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{718:function(t,s,a){"use strict";a.r(s);var n=a(6),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[a("a",{attrs:{href:"https://www.mitmproxy.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("mitmproxy 就是用于 MITM 的 proxy，MITM 即中间人攻击（Man-in-the-middle attack）。用于中间人攻击的代理首先会向正常的代理一样转发请求，保障服务端与客户端的通信，其次，会适时的查、记录其截获的数据，或篡改数据，引发服务端或客户端特定的行为。")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://cdn.itaolaity.com/20200219180211.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("特点")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("和正常的代理一样转发请求，保障服务端、客户端运行")])]),t._v(" "),a("li",[a("p",[t._v("拦截请求、修改请求、拦截返回、修改返回")])]),t._v(" "),a("li",[a("p",[t._v("载入自定义Python脚本")])])]),t._v(" "),a("p",[a("strong",[t._v("三大组件")])]),t._v(" "),a("ul",[a("li",[t._v("mitmproxy")]),t._v(" "),a("li",[t._v("mitmdump")]),t._v(" "),a("li",[t._v("mitmweb")])]),t._v(" "),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}}),t._v(" 安装")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ mitmweb --version\nMitmproxy: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.0")]),t._v(".4\nPython:    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.7")]),t._v(".3\nOpenSSL:   OpenSSL "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v(".0i  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),t._v("\nPlatform:  Windows-10-10.0.17763-SP0\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ mitmdump --version\nMitmproxy: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.0")]),t._v(".4\nPython:    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.7")]),t._v(".3\nOpenSSL:   OpenSSL "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v(".0i  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),t._v("\nPlatform:  Windows-10-10.0.17763-SP0\n")])])]),a("h4",{attrs:{id:"安装证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装证书"}}),t._v(" 安装证书")]),t._v(" "),a("p",[t._v("前提要启动服务")]),t._v(" "),a("div",{staticClass:"language-shelll extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("mitmproxy -p 8200 --set block_global=false\n")])])]),a("p",[t._v("将浏览器切换代理8080端口")]),t._v(" "),a("p",[a("code",[t._v("http://mitm.it/")])]),t._v(" "),a("p",[a("img",{attrs:{src:"http://cdn.itaolaity.com/20200219152600.png",alt:""}})]),t._v(" "),a("p",[t._v("下载相关平台的新人证书然后导入，即可。")]),t._v(" "),a("h3",{attrs:{id:"运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行"}}),t._v(" 运行")]),t._v(" "),a("p",[t._v("要启动 mitmproxy 用 "),a("code",[t._v("mitmproxy")]),t._v("、"),a("code",[t._v("mitmdump")]),t._v("、"),a("code",[t._v("mitmweb")]),t._v(" 这三个命令中的任意一个即可，这三个命令功能一致，且都可以加载自定义脚本，唯一的区别是交互界面的不同。")]),t._v(" "),a("img",{attrs:{src:"http://alicdn.itaolaity.com/img/20200410223503.png"}}),t._v(" "),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}}),t._v(" 命令")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("mitmproxy \n-p  // 设置监听端口号\n--set "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("block_global")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false // 公网环境需要设置否则失败连接\n")])])]),a("p",[t._v('[hint  type="info" title=“提示”]\n'),a("strong",[t._v("mitmproxy")]),t._v("是一个控制台工具  使用"),a("code",[t._v("?")]),t._v("快捷键从任何"),a("strong",[t._v("mitmproxy")]),t._v("屏幕上查看帮助文档\n[/hint]")]),t._v(" "),a("h2",{attrs:{id:"过滤表达式f"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#过滤表达式f"}}),t._v(" 过滤表达式"),a("code",[t._v("f")])]),t._v(" "),a("p",[t._v("[hint type=“info” title=“快捷键”]")]),t._v(" "),a("p",[t._v("快捷键f")]),t._v(" "),a("p",[t._v("[/hint]")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("~a")]),t._v(" "),a("th",[t._v("过滤返回来的资源比如 CSS, Javascript, Flash, images.")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~b regex")]),t._v(" "),a("td",[t._v("Body")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~bq regex")]),t._v(" "),a("td",[t._v("Request body")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~bs regex")]),t._v(" "),a("td",[t._v("Response body")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~c int")]),t._v(" "),a("td",[t._v("HTTP response code")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~d regex")]),t._v(" "),a("td",[t._v("域名正则")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~dst regex")]),t._v(" "),a("td",[t._v("Match destination address")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~e")]),t._v(" "),a("td",[t._v("Match error")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~h regex")]),t._v(" "),a("td",[t._v("Header")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~hq regex")]),t._v(" "),a("td",[t._v("Request header")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~hs regex")]),t._v(" "),a("td",[t._v("Response header")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~http")]),t._v(" "),a("td",[t._v("Match HTTP flows")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~m regex")]),t._v(" "),a("td",[t._v("Method")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~marked")]),t._v(" "),a("td",[t._v("Match marked flows")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~q")]),t._v(" "),a("td",[t._v("Match request with no response")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~s")]),t._v(" "),a("td",[t._v("Match response")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~src regex")]),t._v(" "),a("td",[t._v("Match source address")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~t regex")]),t._v(" "),a("td",[t._v("Content-type header")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~tcp")]),t._v(" "),a("td",[t._v("Match TCP flows")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~tq regex")]),t._v(" "),a("td",[t._v("Request Content-Type header")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~ts regex")]),t._v(" "),a("td",[t._v("Response Content-Type header")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~u regex")]),t._v(" "),a("td",[t._v("URL")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("~websocket")]),t._v(" "),a("td",[t._v("Match WebSocket flows")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("!")]),t._v(" "),a("td",[t._v("not")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("&")]),t._v(" "),a("td",[t._v("and")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("|")]),t._v(" "),a("td",[t._v("or")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("(...)")]),t._v(" "),a("td",[t._v("grouping")])])])]),t._v(" "),a("p",[t._v("[hint type=“info”  title=“提示”]")]),t._v(" "),a("ul",[a("li",[t._v("正则表达式是Python风格的")])]),t._v(" "),a("p",[t._v("[/hint]")]),t._v(" "),a("h3",{attrs:{id:"例子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例子"}}),t._v(" 例子")]),t._v(" "),a("blockquote",[a("p",[t._v("过滤只有百度的域名")])]),t._v(" "),a("p",[t._v("按"),a("code",[t._v("f")]),t._v(" 然后输入过滤规则"),a("code",[t._v("~d baidu.com")])]),t._v(" "),a("img",{attrs:{src:"http://alicdn.itaolaity.com/img/20200410233229.png"}}),t._v(" "),a("blockquote",[a("p",[t._v("过滤请求方法为Post且域名为包含baidu的数据流")])]),t._v(" "),a("p",[a("code",[t._v("~d baidu.com % ~m post")])]),t._v(" "),a("img",{attrs:{src:"http://alicdn.itaolaity.com/img/20200410233518.png"}}),t._v(" "),a("h2",{attrs:{id:"断点拦截i"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#断点拦截i"}}),t._v(" 断点拦截"),a("code",[t._v("i")])]),t._v(" "),a("p",[t._v("[hint type=“info”  title=“快捷键”]")]),t._v(" "),a("p",[t._v("快捷键i")]),t._v(" "),a("p",[t._v("[/hint]")]),t._v(" "),a("blockquote",[a("p",[t._v("请求拦截")])]),t._v(" "),a("p",[t._v("比如想要拦截"),a("code",[t._v("itaolaity.com")]),t._v(" 的数据")]),t._v(" "),a("img",{attrs:{src:"http://alicdn.itaolaity.com/img/20200410234024.png"}}),t._v(" "),a("p",[t._v("然后停留到这里来了，且时间为红色标记")]),t._v(" "),a("img",{attrs:{src:"http://alicdn.itaolaity.com/img/20200410234207.png"}}),t._v(" "),a("p",[t._v("按下回车查看详细信息。且按下"),a("code",[t._v("e")])]),t._v(" "),a("img",{attrs:{src:"http://alicdn.itaolaity.com/img/20200410234436.png"}}),t._v(" "),a("p",[t._v("选择要修改的参数")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("比如\ncookies\nurl\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])])]),a("p",[t._v("最后返回界面按下"),a("code",[t._v("a")]),t._v(" 继续往下走。")]),t._v(" "),a("h2",{attrs:{id:"脚本-mitmdump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#脚本-mitmdump"}}),t._v(" 脚本 - mitmdump")]),t._v(" "),a("p",[t._v("编写一个py文件提供给mitmproxy加载。")]),t._v(" "),a("p",[t._v("文件中定义了若干函数，这些函数实现了某些 mitmproxy 提供的事件，mitmproxy 会在某个事件发生时调用对应的函数")]),t._v(" "),a("p",[t._v("或者 编写一个 py 文件供 mitmproxy 加载，文件定义了变量 addons，addons 是个数组，每个元素是一个类实例，这些类有若干方法，这些方法实现了某些 mitmproxy 提供的事件，mitmproxy 会在某个事件发生时调用对应的方法。这些类，称为一个个 "),a("code",[t._v("addon")]),t._v("，比如一个叫 Counter 的 addon")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" mitmproxy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ctx\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Counter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"We\'ve seen %d flows"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\naddons "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    Counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[a("strong",[t._v("启动")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("mitmdump -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("编写一个py脚本用来供mitmproxy加载。")]),t._v(" "),a("p",[t._v("实现mitmproxy提供的事件，mitmproxy会在某个事件发生调用相关函数。")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("mitmdump \n-p 指定端口号\n-s 指定py脚本\n-w 指定写入文件 默认将所有流量写入outfile\n")])])]),a("blockquote",[a("p",[t._v("测试")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http处理模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" mitmproxy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ctx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日志模块")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"URL: \\t"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请求头")]),t._v("\n    ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("warn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("λ mitmdump -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v(" -s main.py\nLoading script main.py "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 加载脚本")]),t._v("\nProxy server listening at http://*:8080 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#监听端口")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1:14072: clientconnect\nURL:    https://sug.so.360.cn/suggest?encodein"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("encodeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("opensearch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("word")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\nHeaders"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Host'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sug.so.360.cn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Connection'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'keep-alive'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sec-Fetch-Site'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sec-Fetch-Mode'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'no-cors'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User-Agent'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept-Encoding'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gzip, deflate, br'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept-Language'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh,zh-CN;q=0.9,en;q=0.8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Cookie'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__huid=110y7q8GOJVD4AeHprC/qVgeaKmeZo0r/0O1mg48NrWBQ=; __guid=209084363.1328179603006700032.1557537740001.3984; __gid=156009789.758223608.1572875073297.1572875076825.4; __DC_gid=156009789.758223608.1572875073297.1573629455750.9'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n/suggest?encodein"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("encodeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("opensearch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("word")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1:14072: GET https://sug.so.360.cn/suggest?encodein"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("encodeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("opensearch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("word")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" OK 7b\nURL:    https://sug.so.360.cn/suggest?encodein"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("encodeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("opensearch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("word")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i\nHeaders"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Host'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sug.so.360.cn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Connection'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'keep-alive'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sec-Fetch-Site'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Sec-Fetch-Mode'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'no-cors'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User-Agent'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept-Encoding'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gzip, deflate, br'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept-Language'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh,zh-CN;q=0.9,en;q=0.8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Cookie'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__huid=110y7q8GOJVD4AeHprC/qVgeaKmeZo0r/0O1mg48NrWBQ=; __guid=209084363.1328179603006700032.1557537740001.3984; __gid=156009789.758223608.1572875073297.1572875076825.4; __DC_gid=156009789.758223608.1572875073297.1573629455750.9'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n/suggest?encodein"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("encodeout")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("opensearch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("word")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i\n")])])]),a("p",[t._v("定义了一个request()方法。参数为flow，它其实是一个HTTPFlow对象。通过request属性即可获取到当前请求对象。")]),t._v(" "),a("h4",{attrs:{id:"日志输出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日志输出"}}),t._v(" 日志输出")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("from mitmproxy "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v(" ctx\n")])])]),a("p",[t._v("可以设定不同级别的不同颜色的结果")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("ctx.log.info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" // 白色\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".warn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" // 黄色\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("// 红色\n")])])]),a("p",[t._v("调用ctx模块")]),t._v(" "),a("h4",{attrs:{id:"request对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#request对象"}}),t._v(" Request对象")]),t._v(" "),a("p",[t._v("Request对象什么功能呢？")]),t._v(" "),a("blockquote",[a("p",[t._v("例子 - 常用属性")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" mitmproxy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ctx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日志模块")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    info "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info\n    request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n\\n+++++++++++++++++  开始  ++++++++++++++++++++++"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"URL: \\t"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Headers: \\t"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cookies: \\t"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Method: \\t"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Port: \\t"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Scheme: \\t"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scheme"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+++++++++++++++++++++++++++++++++++++++\\n\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("URL: https://blog.itaolaity.com/usr/plugins/Mirages/biaoqing/paopao/E5A4A7E68B87E68C87_2x.png                                                          \nHeaders: Headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Host'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'blog.itaolaity.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Connection'")]),t._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'keep-alive'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCookies: MultiDictView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("'crisp-client%2Fsession%2F1e699570-3cf8-4358-a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".                                                                                                               \nMethod: GET                                                                                                                                       \nPort: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("                                                                                                                                               \nScheme: https                                                                                                                                  \n")])])]),a("hr"),t._v(" "),a("blockquote",[a("p",[t._v("伪造站点")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://blog.itaolaity.com/'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'itaolaity.com'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" url\n\n")])])]),a("p",[a("img",{attrs:{src:"http://cdn.itaolaity.com/20200219175044.png",alt:""}})]),t._v(" "),a("p",[t._v("可以看到无论访问什么网站，都会访问指定url但是上面的域名还是要访问的。")]),t._v(" "),a("h4",{attrs:{id:"response对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#response对象"}}),t._v(" Response对象")]),t._v(" "),a("p",[t._v("响应内容，Response Body才是爬取的结果。")]),t._v(" "),a("blockquote",[a("p",[t._v("测试")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status_code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"响应内容： \\t"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件"}}),t._v(" 事件")]),t._v(" "),a("p",[t._v("事件针对不同生命周期分为 5 类 。")]),t._v(" "),a("p",[t._v("同样是一次 web 请求，我可以理解为“HTTP 请求 -> HTTP 响应”的过程，也可以理解为“TCP 连接 -> TCP 通信 -> TCP 断开”的过程。那么，如果我想拒绝来个某个 IP 的客户端请求，应当注册函数到针对 TCP 生命周期 的 "),a("code",[t._v("tcp_start")]),t._v(" 事件，又或者，我想阻断对某个特定域名的请求时，则应当注册函数到针对 HTTP 声明周期的 "),a("code",[t._v("http_connect")]),t._v(" 事件")]),t._v(" "),a("h3",{attrs:{id:"http周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http周期"}}),t._v(" http周期")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("http_connect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("p",[t._v("(Called when) 收到了来自客户端的 HTTP CONNECT 请求。在 flow 上设置非 2xx 响应将返回该响应并断开连接。CONNECT 不是常用的 HTTP 请求方法，目的是与服务器建立代理连接，仅是 client 与 proxy 的之间的交流，所以 CONNECT 请求不会触发 request、response 等其他常规的 HTTP 事件。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestheaders")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("p",[t._v("(Called when) 来自客户端的 HTTP 请求的头部被成功读取。此时 flow 中的 request 的 body 是空的")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("p",[t._v("(Called when) 来自服务端端的 HTTP 响应被成功完整读取")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("p",[t._v("(Called when) 发生了一个 HTTP 错误。比如无效的服务端响应、连接断开等。注意与“有效的 HTTP 错误返回”不是一回事，后者是一个正确的服务端响应，只是 HTTP code 表示错误而已")]),t._v(" "),a("h3",{attrs:{id:"tcp周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tcp周期"}}),t._v(" tcp周期")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 建立了一个 TCP 连接")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tcp_start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tcp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TCPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TCP 连接收到了一条消息")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tcp_message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tcp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TCPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 发生了 TCP 错误")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tcp_error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tcp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TCPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  TCP 连接关闭")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tcp_end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tcp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TCPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("h3",{attrs:{id:"websocket-生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#websocket-生命周期"}}),t._v(" Websocket 生命周期")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("websocket_handshake")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTPFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("websocket_start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("websocket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebSocketFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("websocket_message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("websocket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebSocketFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("websocket_error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("websocket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebSocketFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("websocket_end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("websocket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WebSocketFlow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("h3",{attrs:{id:"网络连接生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络连接生命周期"}}),t._v(" 网络连接生命周期")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# \t客户端连接到了 mitmproxy。注意一条连接可能对应多个 HTTP 请求")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clientconnect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 客户端断开了和 mitmproxy 的连接")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clientdisconnect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("serverconnect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connections"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ServerConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("serverdisconnect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" conn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connections"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ServerConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next_layer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mitmproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("proxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Layer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}}),t._v(" 参考")]),t._v(" "),a("ul",[a("li",[t._v("官方文档")])]),t._v(" "),a("p",[t._v("https://docs.mitmproxy.org/stable/concepts-filters/")]),t._v(" "),a("ul",[a("li",[t._v("官网")])]),t._v(" "),a("p",[t._v("https://www.mitmproxy.org/")]),t._v(" "),a("ul",[a("li",[t._v("博客")])]),t._v(" "),a("p",[t._v("https://www.cnblogs.com/grandlulu/p/9525417.html")]),t._v(" "),a("p",[t._v("https://blog.wolfogre.com/")])])}),[],!1,null,null,null);s.default=e.exports}}]);